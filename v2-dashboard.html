<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>V2 Dashboard - Cultureful</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --bg-body: #f8fafc;
            /* Slate-50 */
            --bg-card: #ffffff;
            /* White */
            --primary: #0d9488;
            /* Teal-700 */
            --primary-light: #ccfbf1;
            /* Teal-100 */
            --secondary: #4f46e5;
            /* Indigo-600 */
            --text-main: #0f172a;
            /* Slate-900 */
            --text-muted: #64748b;
            /* Slate-500 */
            --success: #10b981;
            /* Emerald-500 */
            --success-bg: #d1fae5;
            /* Emerald-100 */
            --border-color: #e2e8f0;
            /* Slate-200 */
            --shadow-sm: 0 1px 2px 0 rgb(0 0 0 / 0.05);
            --shadow-md: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            --shadow-lg: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Outfit', sans-serif;
        }

        body {
            background-color: var(--bg-body);
            color: var(--text-main);
            line-height: 1.6;
            padding-bottom: 4rem;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 1.5rem;
        }

        /* HEADER & FILTER */
        header {
            padding: 4rem 0 2rem;
            border-bottom: 1px solid var(--border-color);
            margin-bottom: 3rem;
            text-align: center;
            /* Center align header for better filter placement */
        }

        header .brand {
            margin-bottom: 1rem;
        }

        header .brand img {
            height: 60px;
            margin: 0 auto;
            display: block;
        }

        h1 {
            font-size: 2.5rem;
            font-weight: 700;
            margin-bottom: 0.5rem;
            color: var(--text-main);
            background: linear-gradient(135deg, #0f172a 0%, #334155 100%);
            -webkit-background-clip: text;
            background-clip: text;
            -webkit-text-fill-color: transparent;
        }

        .subtitle {
            color: var(--text-muted);
            font-size: 1.125rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1rem;
            margin-bottom: 2rem;
        }

        .badge {
            background: var(--bg-card);
            border: 1px solid var(--border-color);
            padding: 0.25rem 0.75rem;
            border-radius: 99px;
            font-size: 0.75rem;
            color: var(--text-muted);
            font-weight: 600;
            box-shadow: var(--shadow-sm);
            transition: opacity 0.2s;
        }

        .filter-bar {
            display: inline-flex;
            justify-content: center;
            gap: 0.5rem;
            background: var(--bg-card);
            padding: 0.5rem;
            border-radius: 99px;
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow-sm);
        }

        .filter-btn {
            background: transparent;
            border: 1px solid transparent;
            padding: 0.5rem 1.25rem;
            border-radius: 99px;
            font-size: 0.875rem;
            color: var(--text-muted);
            cursor: pointer;
            transition: all 0.2s;
            font-weight: 600;
        }

        .filter-btn:hover {
            color: var(--text-main);
            background: #f1f5f9;
        }

        .filter-btn.active {
            background-color: var(--secondary);
            color: white;
            box-shadow: 0 4px 12px rgba(79, 70, 229, 0.3);
        }

        .explorer-btn {
            background-color: #f1f5f9;
            color: var(--secondary);
            border: 2px solid var(--secondary);
            padding: 0.6rem 1.2rem;
            border-radius: 0.75rem;
            cursor: pointer;
            font-weight: 700;
            font-size: 0.9rem;
            text-decoration: none;
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            transition: all 0.2s;
            margin-left: auto;
        }

        .explorer-btn:hover {
            background-color: var(--secondary);
            color: white;
            transform: translateY(-2px);
        }

        /* HERO - MULTIPLIER */
        .hero {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            margin-bottom: 4rem;
            text-align: left;
            /* Reset text align */
        }

        .hero-card {
            background: var(--bg-card);
            border-radius: 1.5rem;
            padding: 3rem;
            position: relative;
            overflow: hidden;
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow-md);
            transition: transform 0.3s ease, box-shadow 0.3s ease;
        }

        .hero-card:hover {
            transform: translateY(-5px);
            border-color: var(--primary);
            box-shadow: var(--shadow-lg);
        }

        .hero-label {
            color: var(--text-muted);
            font-size: 0.875rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            margin-bottom: 1rem;
            font-weight: 600;
        }

        .hero-stat {
            font-size: 5rem;
            font-weight: 800;
            color: var(--primary);
            margin-bottom: 0.5rem;
            line-height: 1;
        }

        .hero-stat span {
            font-size: 2rem;
            opacity: 0.5;
            color: var(--text-main);
        }

        .hero-desc {
            font-size: 1.25rem;
            max-width: 90%;
            color: var(--text-main);
        }

        .hero-highlight {
            background: linear-gradient(135deg, #f0f9ff 0%, #e0f2fe 100%);
            border: 1px solid #bae6fd;
        }

        .ref-code {
            display: inline-block;
            font-family: monospace;
            font-size: 0.75rem;
            background: #e2e8f0;
            color: #475569;
            padding: 0.1rem 0.4rem;
            border-radius: 0.2rem;
            margin-left: 0.5rem;
            vertical-align: text-top;
        }

        .tech-tooltip {
            border-bottom: 1px dotted var(--text-muted);
            cursor: help;
        }

        /* GRID - DRIVERS */
        .section-title {
            font-size: 1.5rem;
            margin-bottom: 2rem;
            padding-left: 1rem;
            border-left: 4px solid var(--primary);
            color: var(--text-main);
            font-weight: 700;
            text-align: left;
        }

        .grid-3 {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-bottom: 4rem;
            text-align: left;
        }

        .card {
            background: var(--bg-card);
            padding: 2rem;
            border-radius: 1rem;
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow-sm);
            transition: all 0.2s ease;
        }

        .card:hover {
            transform: translateY(-2px);
            box-shadow: var(--shadow-md);
            border-color: var(--primary);
        }

        .card-icon {
            font-size: 2rem;
            margin-bottom: 1rem;
            color: var(--primary);
            font-weight: 800;
            font-family: monospace;
            letter-spacing: -1px;
        }

        .card h3 {
            font-size: 1.25rem;
            margin-bottom: 0.5rem;
            color: var(--text-main);
            font-weight: 700;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .card h3 span {
            font-family: monospace;
            font-size: 0.875rem;
            color: var(--secondary);
            background: #e0e7ff;
            padding: 0.1rem 0.5rem;
            border-radius: 0.3rem;
        }

        .card-stat {
            font-size: 2.5rem;
            font-weight: 700;
            color: var(--success);
            margin: 1rem 0;
            display: flex;
            align-items: baseline;
            gap: 0.5rem;
        }

        .card-stat small {
            font-size: 1rem;
            color: var(--text-muted);
            font-weight: 500;
        }

        /* Strategic Tools Section */
        .tools-grid {
            display: grid;
            grid-template-columns: repeat(3, 1fr);
            gap: 1.5rem;
            margin-bottom: 3rem;
        }

        @media (max-width: 900px) {
            .tools-grid {
                grid-template-columns: 1fr;
            }
        }

        .tool-card {
            background: linear-gradient(135deg, #ffffff 0%, #f8fafc 100%);
            border: 1px solid #e2e8f0;
            border-bottom: 4px solid var(--primary);
            border-radius: 1rem;
            padding: 1.5rem;
            transition: transform 0.3s ease;
        }

        .tool-card:hover {
            transform: translateY(-5px);
        }

        .tool-title {
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 0.5rem;
            font-size: 1.1rem;
        }

        .tool-stat {
            font-size: 2rem;
            font-weight: 800;
            color: var(--secondary);
            margin: 0.5rem 0;
        }

        .tool-metric {
            font-size: 0.8rem;
            color: var(--text-muted);
            text-transform: uppercase;
            letter-spacing: 0.05em;
            margin-bottom: 1rem;
        }

        .tool-insight {
            font-size: 0.9rem;
            line-height: 1.5;
            color: #475569;
            position: relative;
            padding-left: 1rem;
            border-left: 2px solid #cbd5e1;
        }


        .card-p {
            color: var(--text-muted);
            font-size: 0.95rem;
            margin-bottom: 1.5rem;
        }

        .card-badge {
            display: inline-block;
            background: var(--primary-light);
            color: var(--primary);
            padding: 0.5rem 1rem;
            border-radius: 0.5rem;
            font-size: 0.875rem;
            font-weight: 600;
        }

        /* DEEP DIVE TABLE */
        .analytics-container {
            margin-top: 4rem;
            text-align: left;
        }

        .analytics-table {
            width: 100%;
            border-collapse: separate;
            border-spacing: 0 0.5rem;
        }

        .analytics-table th {
            text-align: left;
            padding: 1rem 1.5rem;
            color: var(--text-muted);
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 1px;
            font-weight: 600;
        }

        .analytics-table td {
            background: var(--bg-card);
            padding: 1.5rem;
            vertical-align: middle;
            border-top: 1px solid var(--border-color);
            border-bottom: 1px solid var(--border-color);
        }

        .analytics-table tr td:first-child {
            border-top-left-radius: 0.75rem;
            border-bottom-left-radius: 0.75rem;
            border-left: 1px solid var(--border-color);
        }

        .analytics-table tr td:last-child {
            border-top-right-radius: 0.75rem;
            border-bottom-right-radius: 0.75rem;
            border-right: 1px solid var(--border-color);
        }

        .analytics-table tr:hover td {
            background-color: #f8fafc;
            border-color: #cbd5e1;
        }

        .q-code {
            font-family: monospace;
            color: var(--secondary);
            font-weight: 700;
            background: #e0e7ff;
            /* Indigo-100 */
            padding: 0.25rem 0.5rem;
            border-radius: 0.25rem;
            margin-right: 0.75rem;
            font-size: 0.85rem;
        }

        .q-text {
            font-weight: 600;
            color: var(--text-main);
            display: block;
            margin-bottom: 0.25rem;
        }

        /* EXPERT INSIGHT STYLING */
        .expert-insight {
            margin-top: 0.75rem;
            font-size: 0.85rem;
            color: var(--text-muted);
            line-height: 1.5;
            padding-left: 0.75rem;
            border-left: 2px solid var(--secondary);
            font-style: italic;
        }

        .q-full {
            font-size: 0.85rem;
            color: var(--text-muted);
            display: block;
            max-width: 500px;
        }

        .stat-value {
            font-weight: 700;
            color: var(--success);
            font-size: 1.1rem;
        }

        .stat-label {
            font-size: 0.75rem;
            color: var(--text-muted);
            display: block;
        }

        .r2-badge {
            background: #f1f5f9;
            color: #475569;
            padding: 0.25rem 0.5rem;
            border-radius: 0.375rem;
            border: 1px solid #e2e8f0;
            font-size: 0.8rem;
            font-weight: 600;
        }

        .simple-interpretation {
            font-size: 0.75rem;
            color: #94a3b8;
            margin-top: 0.25rem;
            line-height: 1.4;
            font-style: italic;
        }

        /* FORECAST TABLE */
        .table-container {
            background: var(--bg-card);
            border-radius: 1rem;
            overflow: hidden;
            border: 1px solid var(--border-color);
            box-shadow: var(--shadow-sm);
            text-align: left;
        }

        .forecast-table {
            width: 100%;
            border-collapse: collapse;
        }

        .forecast-table th {
            text-align: left;
            padding: 1.5rem;
            background: #f1f5f9;
            font-weight: 600;
            color: var(--text-muted);
            font-size: 0.875rem;
            text-transform: uppercase;
        }

        .forecast-table td {
            padding: 1.5rem;
            border-top: 1px solid var(--border-color);
            vertical-align: top;
        }

        .strong-text {
            color: var(--text-main);
            font-weight: 600;
        }

        .impact-arrow {
            color: var(--success);
            margin-right: 0.5rem;
            font-weight: 800;
        }

        /* FOOTER */
        footer {
            margin-top: 5rem;
            border-top: 1px solid var(--border-color);
            padding-top: 2rem;
            color: var(--text-muted);
            font-size: 0.875rem;
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 2rem;
            text-align: left;
        }

        .methodology h4 {
            color: var(--text-main);
            margin-bottom: 0.5rem;
            font-weight: 600;
        }

        /* RESPONSIVE */
        @media (max-width: 768px) {
            .hero {
                grid-template-columns: 1fr;
            }

            h1 {
                font-size: 2rem;
            }

            footer {
                grid-template-columns: 1fr;
            }
        }

        /* ANIMATION */
        .fade-in {
            animation: fadeIn 0.6s ease forwards;
            opacity: 0;
        }

        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(10px);
            }

            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .delay-1 {
            animation-delay: 0.1s;
        }

        .delay-2 {
            animation-delay: 0.2s;
        }

        .delay-3 {
            animation-delay: 0.3s;
        }

        /* HIDDEN FOR FILTER */
        .hidden-row {
            display: none !important;
        }
    </style>
</head>

<body>

    <div class="container">

        <header>
            <div class="brand">
                <img src="https://kajabi-storefronts-production.kajabi-cdn.com/kajabi-storefronts-production/file-uploads/themes/2162925514/settings_images/b6e388-a667-4c86-513-e3c3cb86f5e_441ffcc7-b72f-40b5-a1ef-54caaf22bba8.png"
                    alt="Cultureful Logo">
            </div>
            <h1>V2 Executive Dashboard</h1>
            <div class="subtitle">
                <span>Leading Indicators of Organizational Health - V2 Only</span>
                <span class="badge" id="n-badge">N = 4,646 V2 Responses</span>
            </div>

            <!-- Navigation -->
            <div class="filter-bar" style="display: flex; align-items: center; gap: 1rem; width: 100%; flex-wrap: wrap;">
                <div style="display: flex; gap: 0.5rem; flex-wrap: wrap;">
                    <a href="index.html" class="filter-btn" style="text-decoration: none; display: inline-flex; align-items: center; justify-content: center;">All Data (v1+v2)</a>
                    <span class="filter-btn active" style="cursor: default; background-color: var(--primary); color: white;">V2 Only (Current)</span>
                </div>
                <div style="display: flex; gap: 1rem; align-items: center; margin-left: auto; flex-wrap: wrap;">
                    <a href="qualitative-insights.html" class="explorer-btn" style="background-color: var(--primary); color: white; border-color: var(--primary);">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                            stroke-linecap="round" stroke-linejoin="round">
                            <path d="M21 15a2 2 0 0 1-2 2H7l-4 4V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2z"></path>
                        </svg>
                        Qualitative Insights
                    </a>
                    <a href="analytics.html" class="explorer-btn">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                            stroke-linecap="round" stroke-linejoin="round">
                            <line x1="18" y1="20" x2="18" y2="10"></line>
                            <line x1="12" y1="20" x2="12" y2="4"></line>
                            <line x1="6" y1="20" x2="6" y2="14"></line>
                        </svg>
                        Explore All Analytics (Q1-Q23)
                    </a>
                </div>
            </div>
        </header>

        <!-- Hero Section -->
        <div class="hero">
            <div class="hero-card fade-in">
                <div class="hero-label">Headline Insight <span class="ref-code">Growth & Purpose</span></div>
                <div class="hero-stat">1.12<span>x</span></div>
                <div class="hero-desc">
                    <strong>The Growth Multiplier.</strong><br>
                    For every 10% gain in strategic alignment (Purpose & Growth), you achieve an <strong>11.2%</strong>
                    improvement in Employee <span class="tech-tooltip"
                        title="Database ID: metric_wellbeing">Wellbeing</span>. Investment in people pays back with
                    interest.
                </div>
            </div>

            <div class="hero-card fade-in delay-1 hero-highlight"
                style="display:flex; align-items:center; justify-content:center;">
                <div style="text-align:center;">
                    <div style="font-size: 1.5rem; margin-bottom:1rem; color: #475569; font-weight: 500;">Efficiency
                        Leader <span class="ref-code">MEAN01</span></div>
                    <div style="font-size: 4rem; font-weight:800; color:var(--secondary);">Meaning</div>
                    <div style="color:var(--text-muted); margin-top:0.5rem; font-size: 1.1rem;">is the #1 driver of
                        performance</div>
                </div>
            </div>
        </div>

        <!-- Culture Fix Strategic Tools Spotlight -->
        <h2 class="section-title fade-in delay-1">Culture Fix™ Strategic Tools Impact</h2>
        <div class="tools-grid fade-in delay-2" id="toolsSpotlight">
            <!-- Populated by JS -->
        </div>

        <!-- Big Three Drivers -->
        <h2 class="section-title fade-in delay-2">The "Big Three" Strategic Drivers</h2>
        <div class="grid-3">

            <!-- Card 1 -->
            <div class="card fade-in delay-2">
                <div class="card-icon">01</div>
                <h3>Purpose Connection <span>MEAN01</span></h3>
                <div class="card-stat">+23.3 pts <small>on <span class="tech-tooltip"
                            title="Database ID: metric_wellbeing">Wellbeing</span></small></div>
                <p class="card-p">Connecting daily tasks to human outcomes is the strongest statistical predictor of
                    employee resilience.</p>
                <div class="card-badge">Highest Impact</div>
            </div>

            <!-- Card 2 -->
            <div class="card fade-in delay-3">
                <div class="card-icon">02</div>
                <h3>Leadership Care <span>SAF03</span></h3>
                <div class="card-stat">+20.7% <small>on <span class="tech-tooltip"
                            title="Database ID: metric_wellbeing">Wellbeing</span></small></div>
                <p class="card-p">Active care from senior leadership serves as the primary gateway to organizational
                    trust
                    and retention.</p>
                <div class="card-badge">Critical Foundation</div>
            </div>

            <!-- Card 3 -->
            <div class="card fade-in delay-3">
                <div class="card-icon">03</div>
                <h3>Value Integrity <span>VA01</span></h3>
                <div class="card-stat">+15.7% <small>on <span class="tech-tooltip"
                            title="Database ID: metric_culture_fix_index">Culture Health</span></small></div>
                <p class="card-p">Shared behaviors act as "operational glue," reducing friction and increasing decision
                    integrity across teams.</p>
                <div class="card-badge">Culture Driver</div>
            </div>

        </div>

        <!-- Projected Outcomes -->
        <h2 class="section-title fade-in delay-3">Predictive Impact Modeling (Statistical Forecast)</h2>
        <div class="table-container fade-in delay-3">
            <table class="forecast-table">
                <thead>
                    <tr>
                        <th style="width: 40%">Input Question (Factor to Improve)</th>
                        <th style="width: 40%">Correlated Outcome (Projected Metric Lift)</th>
                        <th>Evidence Confidence</th>
                    </tr>
                </thead>
                <tbody>
                    <tr data-versions="v1 v2">
                        <td>
                            Increase <span class="strong-text">[MEAN01] Meaningful Manager Impact</span>
                            <div class="expert-insight">
                                <strong>Actionable Insight:</strong> Train managers to be "Purpose Connectors."
                                Connecting the "why" to the "what" is the most efficient way to simultaneously boost
                                output and reduce burnout risk.
                            </div>
                        </td>
                        <td><span class="impact-arrow">&uarr;</span> Projected <strong>+23.4%</strong> in <span
                                class="strong-text"><span class="tech-tooltip"
                                    title="Database ID: metric_wellbeing">Wellbeing</span></span></td>
                        <td><span class="badge"
                                style="background:var(--success-bg); color:var(--success); border:none;">R² = 0.45
                                (Strong)</span></td>
                    </tr>
                    <tr data-versions="v1 v2">
                        <td>
                            Increase <span class="strong-text">[SAF03] Senior Leader Care</span>
                            <div class="expert-insight">
                                <strong>Actionable Insight:</strong> Visibility matters. Leaders must move beyond
                                strategy communication to demonstrate human care. This is the single strongest buffer
                                against organizational stress.
                            </div>
                        </td>
                        <td><span class="impact-arrow">&uarr;</span> Projected <strong>+20.7%</strong> in <span
                                class="strong-text"><span class="tech-tooltip"
                                    title="Database ID: metric_wellbeing">Wellbeing</span></span></td>
                        <td><span class="badge"
                                style="background:var(--success-bg); color:var(--success); border:none;">R² = 0.40
                                (Strong)</span></td>
                    </tr>
                    <tr data-versions="v1 v2">
                        <td>
                            Increase <span class="strong-text">[SAF02] Manager Personal Care</span>
                            <div class="expert-insight">
                                <strong>Actionable Insight:</strong> Operationalize empathy. Managers knowing their
                                team's life goals isn't "soft"—it's a critical structural predictor of sustainable high
                                performance.
                            </div>
                        </td>
                        <td><span class="impact-arrow">&uarr;</span> Projected <strong>+20.3%</strong> in <span
                                class="strong-text"><span class="tech-tooltip"
                                    title="Database ID: metric_wellbeing">Wellbeing</span></span></td>
                        <td><span class="badge"
                                style="background:var(--success-bg); color:var(--success); border:none;">R² = 0.42
                                (Strong)</span></td>
                    </tr>
                    <tr data-versions="v1 v2">
                        <td>
                            Increase <span class="strong-text">[VA01] Colleague Values</span>
                            <div class="expert-insight">
                                <strong>Actionable Insight:</strong> The "Shadow Culture" effect. Peer behavior is the
                                true curriculum. If colleagues live the values, the culture creates itself; if they
                                don't, no policy will fix it.
                            </div>
                        </td>
                        <td><span class="impact-arrow">&uarr;</span> Projected <strong>+18.0%</strong> in <span
                                class="strong-text"><span class="tech-tooltip"
                                    title="Database ID: metric_core_values">Core Values</span></span></td>
                        <td><span class="badge"
                                style="background:var(--success-bg); color:var(--success); border:none;">R² = 0.53 (Very
                                Strong)</span></td>
                    </tr>
                    <tr data-versions="v1 v2">
                        <td>
                            Increase <span class="strong-text">[CV03] Values Identification</span>
                            <div class="expert-insight">
                                <strong>Actionable Insight:</strong> Internalization is the goal. When staff truly buy
                                in to values, you get strategic alignment at scale without needing micromanagement.
                            </div>
                        </td>
                        <td><span class="impact-arrow">&uarr;</span> Projected <strong>+17.7%</strong> in <span
                                class="strong-text"><span class="tech-tooltip"
                                    title="Database ID: metric_core_values">Core Values</span></span></td>
                        <td><span class="badge"
                                style="background:var(--success-bg); color:var(--success); border:none;">R² = 0.61 (Very
                                Strong)</span></td>
                    </tr>
                </tbody>
            </table>
        </div>

        <!-- Deep Dive Analytics -->
        <div class="analytics-container fade-in delay-2">
            <h2 class="section-title">Deep Dive: Statistical Correlations by Question</h2>
            <table class="analytics-table">
                <thead>
                    <tr>
                        <th style="width: 50%">Question Driver</th>
                        <th>Impact Target</th>
                        <th>Efficiency Gain</th>
                        <th>Statistical Power</th>
                    </tr>
                </thead>
                <tbody>
                    <tr data-versions="v1 v2">
                        <td>
                            <span class="q-text"><span class="q-code">MEAN01</span> Meaningful Manager Impact</span>
                            <span class="q-full">"My manager shows how my work impacts the company's purpose."</span>
                            <div class="expert-insight">
                                <strong>Insight:</strong> Purpose buffers stress. When people see the "why," they are
                                more resilient to the "what."
                            </div>
                        </td>
                        <td><span class="tech-tooltip" title="Database ID: metric_wellbeing">Wellbeing</span></td>
                        <td>
                            <span class="stat-value">+23.4%</span>
                            <span class="stat-label">Gain per unit increase</span>
                        </td>
                        <td>
                            <span class="r2-badge">R² = 0.45</span>
                        </td>
                    </tr>
                    <tr data-versions="v1 v2">
                        <td>
                            <span class="q-text"><span class="q-code">SAF03</span> Senior Leader Care</span>
                            <span class="q-full">"There is a senior leader who genuinely cares about my
                                development."</span>
                            <div class="expert-insight">
                                <strong>Insight:</strong> Humanize the hierarchy. Perceived care from the top is a
                                massive engagement lever, reducing turnover intent.
                            </div>
                        </td>
                        <td><span class="tech-tooltip" title="Database ID: metric_wellbeing">Wellbeing</span></td>
                        <td>
                            <span class="stat-value">+20.7%</span>
                            <span class="stat-label">Gain per unit increase</span>
                        </td>
                        <td>
                            <span class="r2-badge">R² = 0.40</span>
                        </td>
                    </tr>
                    <tr data-versions="v1 v2">
                        <td>
                            <span class="q-text"><span class="q-code">SAF02</span> Manager Personal Care</span>
                            <span class="q-full">"My manager is aware of my personal interests and life
                                aspirations."</span>
                            <div class="expert-insight">
                                <strong>Insight:</strong> Whole-person leadership. Employees don't leave companies; they
                                leave managers who don't know them.
                            </div>
                        </td>
                        <td><span class="tech-tooltip" title="Database ID: metric_wellbeing">Wellbeing</span></td>
                        <td>
                            <span class="stat-value">+20.3%</span>
                            <span class="stat-label">Gain per unit increase</span>
                        </td>
                        <td>
                            <span class="r2-badge">R² = 0.42</span>
                        </td>
                    </tr>
                    <tr data-versions="v1 v2">
                        <td>
                            <span class="q-text"><span class="q-code">VA01</span> Colleague Values</span>
                            <span class="q-full">"How frequently do your colleagues' behaviors demonstrate core
                                values?"</span>
                            <div class="expert-insight">
                                <strong>Insight:</strong> Culture is what happens when you leave the room. Peer
                                accountability is stronger than policy.
                            </div>
                        </td>
                        <td><span class="tech-tooltip" title="Database ID: metric_culture_fix_index">Culture
                                Health</span></td>
                        <td>
                            <span class="stat-value">+15.7%</span>
                            <span class="stat-label">Gain per unit increase</span>
                        </td>
                        <td>
                            <span class="r2-badge">R² = 0.28</span>
                        </td>
                    </tr>
                    <tr data-versions="v1 v2">
                        <td>
                            <span class="q-text"><span class="q-code">MEAN01</span> Meaningful Manager Impact</span>
                            <span class="q-full">"My manager shows how my work impacts the company's purpose."</span>
                            <div class="expert-insight">
                                <strong>Insight:</strong> Motivation Driver. It's not just about feeling good; it's
                                about seeing impact. This drives discretionary effort.
                            </div>
                        </td>
                        <td><span class="tech-tooltip" title="Database ID: metric_motivation">Motivation</span></td>
                        <td>
                            <span class="stat-value">+17.1%</span>
                            <span class="stat-label">Gain per unit increase</span>
                        </td>
                        <td>
                            <span class="r2-badge">R² = 0.12</span>
                        </td>
                    </tr>
                    <tr data-versions="v1 v2">
                        <td>
                            <span class="q-text"><span class="q-code">MEAN03</span> Growth Opportunities</span>
                            <span class="q-full">"I’m offered opportunities to take risks, learn, and grow."</span>
                            <div class="expert-insight">
                                <strong>Insight:</strong> Growth Capacity. "Growth" isn't just promotion; it's the
                                feeling of expanding professional capacity.
                            </div>
                        </td>
                        <td><span class="tech-tooltip" title="Database ID: metric_motivation">Motivation</span></td>
                        <td>
                            <span class="stat-value">+16.1%</span>
                            <span class="stat-label">Gain per unit increase</span>
                        </td>
                        <td>
                            <span class="r2-badge">R² = 0.11</span>
                        </td>
                    </tr>
                    <tr data-versions="v1 v2">
                        <td>
                            <span class="q-text"><span class="q-code">WD07</span> Purpose Identity</span>
                            <span class="q-full">"I strongly identify with the company's purpose."</span>
                            <div class="expert-insight">
                                <strong>Insight:</strong> Identity Fusion. When personal identity merges with company
                                purpose, "work" becomes "mission."
                            </div>
                        </td>
                        <td><span class="tech-tooltip" title="Database ID: metric_motivation">Motivation</span></td>
                        <td>
                            <span class="stat-value">+16.0%</span>
                            <span class="stat-label">Gain per unit increase</span>
                        </td>
                        <td>
                            <span class="r2-badge">R² = 0.62</span>
                        </td>
                    </tr>
                    <tr data-versions="v1 v2">
                        <td>
                            <span class="q-text"><span class="q-code">LT10</span> Defined Purpose</span>
                            <span class="q-full">"We have defined and communicated a measurable greater purpose."</span>
                            <div class="expert-insight">
                                <strong>Insight:</strong> Clarity is Kind. A defined purpose reduces cognitive load,
                                allowing energy to go into execution.
                            </div>
                        </td>
                        <td><span class="tech-tooltip" title="Database ID: metric_wellbeing">Wellbeing</span></td>
                        <td>
                            <span class="stat-value">+15.9%</span>
                            <span class="stat-label">Gain per unit increase</span>
                        </td>
                        <td>
                            <span class="r2-badge">R² = 0.29</span>
                        </td>
                    </tr>
                    <tr data-versions="v1 v2">
                        <td>
                            <span class="q-text"><span class="q-code">MEAN02</span> Team Support</span>
                            <span class="q-full">"My colleagues genuinely care to support each other and act as one
                                team."</span>
                            <div class="expert-insight">
                                <strong>Insight:</strong> Horizontal Accountability. When peers support peers, the
                                manager stops being the bottleneck.
                            </div>
                        </td>
                        <td><span class="tech-tooltip" title="Database ID: metric_motivation">Motivation</span></td>
                        <td>
                            <span class="stat-value">+15.3%</span>
                            <span class="stat-label">Gain per unit increase</span>
                        </td>
                        <td>
                            <span class="r2-badge">R² = 0.07</span>
                        </td>
                    </tr>
                    <tr data-versions="v1 v2">
                        <td>
                            <span class="q-text"><span class="q-code">VA02</span> Leadership Values</span>
                            <span class="q-full">"How frequently do your leadership's behaviors demonstrate core
                                values?"</span>
                            <div class="expert-insight">
                                <strong>Insight:</strong> The "Walk the Talk" factor. Leader consistency is the primary
                                signal for whether values are real.
                            </div>
                        </td>
                        <td><span class="tech-tooltip" title="Database ID: metric_culture_fix_index">Culture
                                Health</span></td>
                        <td>
                            <span class="stat-value">+15.7%</span>
                            <span class="stat-label">Gain per unit increase</span>
                        </td>
                        <td>
                            <span class="r2-badge">R² = 0.31</span>
                        </td>
                    </tr>
                </tbody>
            </table>
        </div>

        <footer>
            <div class="methodology">
                <h4>Methodology & Confidence</h4>
                <p>Results based on Multilevel Regression Modeling (MixedLM) accounting for organization-level
                    clustering (ICC = 0.39). All reported relationships are statistically significant (p < 0.001).</p>
            </div>
            <div class="meta">
                <p>Generated by Cultureful Architecture Engine</p>
                <p>Data Source: Final Validated Set v2.0</p>
            </div>
        </footer>

    </div>

    <script src="dashboard_data.js"></script>
    <script>
        // #region agent log
        const logData1 = {location:'index.html:1037',message:'Script execution started',data:{dashDataExists:typeof DASHBOARD_DATA!=='undefined',dashDataKeys:typeof DASHBOARD_DATA!=='undefined'?Object.keys(DASHBOARD_DATA):[]},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'A'};
        console.log('[DEBUG]', logData1);
        fetch('http://127.0.0.1:7243/ingest/d3f5dd9c-c95a-47af-bbb0-760cd158a559',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(logData1)}).catch((e)=>console.warn('[DEBUG] Log fetch failed:',e));
        // #endregion
        
        // Full Question Text Mapping (for Deep Dive)
        const QUESTION_FULL_TEXT = {
            "MEAN01": "My manager shows how my work impacts the company's purpose.",
            "MEAN02": "My colleagues genuinely care to support each other and act as one team.",
            "MEAN03": "I’m offered opportunities to take risks, learn, and grow.",
            "SAF01": "I have the necessary resources and support to perform my work at the expected quality.",
            "SAF02": "My manager is aware of my personal interests and life aspirations.",
            "SAF03": "There is a senior leader who genuinely cares about my development.",
            "VA01": "How frequently do your colleagues' behaviors demonstrate core values?",
            "VA02": "How frequently do your leadership's behaviors demonstrate core values?",
            "CV01": "How many of the core values can you recite without looking?",
            "CV02": "Do people talk about the core values enough in your organization?",
            "CV03": "How frequently do you identify with the organizations core values and believe they are more than just words?",
            "LT10": "We have defined and communicated a measurable greater purpose.",
            "WD01": "I work because I am motivated and find it meaningful (vs just minimum requirements).",
            "WD03": "I get to work with great people every day.",
            "WD05": "This company fulfills my career goals and aspirations.",
            "WD07": "I strongly identify with the company's purpose and values.",
            "WD10": "I plan to work for this company for many years to come.",
            "WD101": "I work here because I genuinely want to (vs lacking other opportunities).",
            "WD102": "I am excited to go to work at the beginning of my week.",
            "WD12": "I often recommend the products and services of this company to others.",
            "CTRL01": "My role and what is expected of me are well defined.",
            "CTRL02": "The difficulty level of my daily work aligns well with my skills and abilities.",
            "CTRL03": "I feel that my opinion and input are valued and considered.",
            "REC01": "I receive meaningful recognition both formally and informally for my work.",
            "REC02": "Everyone in the company is accountable and committed to delivering quality work.",
            "CS01": "How would you rate your organizational culture?",
            "CS04": "What score would you give the organization for having a great culture?",
            "CS05": "How likely would you be to recommend working at this organization to a friend?"
        };

        // Initialize
        window.onload = function () {
            // #region agent log
            const logData2 = {location:'index.html:1072',message:'Window onload triggered',data:{dashDataExists:typeof DASHBOARD_DATA!=='undefined',activeBtn:document.querySelector('.filter-btn.active')!==null},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'A'};
            console.log('[DEBUG]', logData2);
            fetch('http://127.0.0.1:7243/ingest/d3f5dd9c-c95a-47af-bbb0-760cd158a559',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(logData2)}).catch((e)=>console.warn('[DEBUG] Log fetch failed:',e));
            // #endregion
            // V2 dashboard is locked to v2 only
            setVersion('v2', null);
        };

        function setVersion(ver, btn) {
            // V2 dashboard is locked to v2 - ignore version parameter
            ver = 'v2';
            
            // #region agent log
            const logData3 = {location:'v2-dashboard.html:1076',message:'setVersion called (locked to v2)',data:{version:ver,btnExists:btn!==null,dashDataExists:typeof DASHBOARD_DATA!=='undefined'},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'B'};
            console.log('[DEBUG]', logData3);
            fetch('http://127.0.0.1:7243/ingest/d3f5dd9c-c95a-47af-bbb0-760cd158a559',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(logData3)}).catch((e)=>console.warn('[DEBUG] Log fetch failed:',e));
            // #endregion

            // Update N Badge logic
            const badge = document.getElementById('n-badge');
            // Try to get data, fallback to empty obj if missing
            const metrics = (typeof DASHBOARD_DATA !== 'undefined' && DASHBOARD_DATA[ver]) ? DASHBOARD_DATA[ver] : null;
            
            // #region agent log
            const logDataBadge = {location:'index.html:1101',message:'Badge check',data:{badgeExists:badge!==null},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'D'};
            console.log('[DEBUG]', logDataBadge);
            fetch('http://127.0.0.1:7243/ingest/d3f5dd9c-c95a-47af-bbb0-760cd158a559',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(logDataBadge)}).catch((e)=>console.warn('[DEBUG] Log fetch failed:',e));
            // #endregion

            // #region agent log
            const logData4 = {location:'index.html:1086',message:'Metrics check',data:{version:ver,metricsExists:metrics!==null,hasNCount:metrics&&metrics.n_count!==undefined,hasStats:metrics&&metrics.stats!==undefined,hasTopDrivers:metrics&&metrics.top_drivers!==undefined},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'B'};
            console.log('[DEBUG]', logData4);
            fetch('http://127.0.0.1:7243/ingest/d3f5dd9c-c95a-47af-bbb0-760cd158a559',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(logData4)}).catch((e)=>console.warn('[DEBUG] Log fetch failed:',e));
            // #endregion

            if (!metrics) {
                // #region agent log
                const logData5 = {location:'index.html:1088',message:'Metrics missing error',data:{version:ver},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'B'};
                console.error('[DEBUG]', logData5);
                fetch('http://127.0.0.1:7243/ingest/d3f5dd9c-c95a-47af-bbb0-760cd158a559',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(logData5)}).catch((e)=>console.warn('[DEBUG] Log fetch failed:',e));
                // #endregion
                console.error("Dashboard data missing for version:", ver);
                return;
            }

            // Fade effect
            const container = document.querySelector('.container');
            if (!container) {
                console.error('[DEBUG] Container element not found');
                return;
            }
            container.style.opacity = '0.7';

            setTimeout(() => {
                // 1. Update Badge
                if (badge) {
                    // V2 dashboard always shows v2 count
                    badge.innerText = `N = ${metrics.n_count.toLocaleString()} V2 Responses`;
                } else {
                    console.warn('[DEBUG] Badge element not found');
                }

                // 2. Update Hero
                const heroSlope = metrics.hero_slope;
                const heroCard = document.querySelector('.hero-card');
                if (!heroCard) {
                    console.warn('[DEBUG] Hero card not found');
                } else {
                    const heroStat = heroCard.querySelector('.hero-stat');
                    const heroDesc = heroCard.querySelector('.hero-desc strong:nth-of-type(2)');

                    if (heroStat) {
                            if (heroSlope > 0) {
                            heroStat.innerHTML = `+${heroSlope.toFixed(1)}<span> pts</span>`;
                            if (heroDesc) heroDesc.innerText = `${heroSlope.toFixed(1)} pts`;
                            const heroDescEl = heroCard.querySelector('.hero-desc');
                            if (heroDescEl) {
                                heroDescEl.style.opacity = '1';
                                // Add interpretation after hero description
                                let interpretation = heroCard.querySelector('.simple-interpretation');
                                if (!interpretation) {
                                    interpretation = document.createElement('div');
                                    interpretation.className = 'simple-interpretation';
                                    interpretation.style.marginTop = '0.75rem';
                                    interpretation.style.textAlign = 'center';
                                    heroDescEl.parentElement.appendChild(interpretation);
                                }
                                interpretation.textContent = `For every 1 point improvement in Purpose & Growth, wellbeing improves by ${heroSlope.toFixed(1)} points.`;
                            }
                        } else {
                            heroStat.innerHTML = `<span style="font-size:2rem; opacity:0.5;">N/A</span>`;
                            if (heroDesc) heroDesc.innerText = "N/A";
                            // Optional: Update text to explain why
                            const heroDescEl = heroCard.querySelector('.hero-desc');
                            if (heroDescEl) heroDescEl.style.opacity = '0.5';
                        }
                    } else {
                        console.warn('[DEBUG] Hero stat element not found');
                    }
                }

                // 3. Update Big Three Cards (Fixed for consistency, but values update)
                // #region agent log
                fetch('http://127.0.0.1:7243/ingest/d3f5dd9c-c95a-47af-bbb0-760cd158a559',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:1120',message:'Before card updates',data:{hasStats:metrics.stats!==undefined,statKeys:metrics.stats?Object.keys(metrics.stats):[],hasTopDrivers:metrics.top_drivers!==undefined,topDriversLength:metrics.top_drivers?metrics.top_drivers.length:0},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'C'})}).catch(()=>{});
                // #endregion
                updateCardStat(0, metrics.stats['MEAN01_metric_wellbeing']);
                updateCardStat(1, metrics.stats['SAF03_metric_wellbeing']);
                updateCardStat(2, metrics.stats['VA01_metric_culture_fix_index']);

                // 4. Update Tables (Dynamic Generation)
                renderToolsSpotlight(metrics);
                renderForecastTable(metrics.top_drivers);
                renderDeepDiveTable(metrics.top_drivers);

                container.style.opacity = '1';
            }, 100);
        }


        function renderToolsSpotlight(metrics) {
            // #region agent log
            fetch('http://127.0.0.1:7243/ingest/d3f5dd9c-c95a-47af-bbb0-760cd158a559',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:1135',message:'renderToolsSpotlight entry',data:{metricsExists:metrics!==null,hasAllResults:metrics&&metrics.all_results!==undefined,allResultsLength:metrics&&metrics.all_results?metrics.all_results.length:0},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'C'})}).catch(()=>{});
            // #endregion
            const container = document.getElementById('toolsSpotlight');
            // #region agent log
            fetch('http://127.0.0.1:7243/ingest/d3f5dd9c-c95a-47af-bbb0-760cd158a559',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:1137',message:'Container check',data:{containerExists:container!==null},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'D'})}).catch(()=>{});
            // #endregion
            if (!container) return;
            container.innerHTML = '';

            const tools = [
                { id: 'LT10', name: 'Strategic Purpose Tool', metric: 'metric_culture_fix_index' },
                { id: 'LT04', name: 'Alignment Scoring Tool', metric: 'metric_culture_fix_index' },
                { id: 'LT02', name: 'Values Imagery Tool', metric: 'metric_core_values' }
            ];

            tools.forEach(tool => {
                // Find stats in all_results
                const res = metrics.all_results && metrics.all_results.find ? metrics.all_results.find(r => r.question_code === tool.id && r.metric_code === tool.metric) : null;
                // #region agent log
                fetch('http://127.0.0.1:7243/ingest/d3f5dd9c-c95a-47af-bbb0-760cd158a559',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:1147',message:'Tool result check',data:{toolId:tool.id,resFound:res!==null,resExists:res!==undefined},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'C'})}).catch(()=>{});
                // #endregion
                if (!res) return;

                const card = document.createElement('div');
                card.className = 'tool-card';
                card.innerHTML = `
                    <div class="tool-title">${tool.name} <span class="ref-code" style="float:right;">${tool.id}</span></div>
                    <div class="tool-metric">Predicting ${res.metric_name}</div>
                    <div class="tool-stat">+${res.slope.toFixed(1)} pts</div>
                    <div class="simple-interpretation" style="margin-top: 0.5rem;">For every 1 point you improve ${tool.name}, ${res.metric_name} improves by ${res.slope.toFixed(1)} points.</div>
                    <div class="tool-insight">${res.insight || 'This structural tool creates high cultural leverage.'}</div>
                `;
                container.appendChild(card);
            });
        }

        function updateCardStat(index, data) {
            // #region agent log
            fetch('http://127.0.0.1:7243/ingest/d3f5dd9c-c95a-47af-bbb0-760cd158a559',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:1162',message:'updateCardStat entry',data:{index:index,dataExists:data!==null,dataValid:data&&data.valid,dataSlope:data&&data.slope},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'E'})}).catch(()=>{});
            // #endregion
            const cards = document.querySelectorAll('.grid-3 .card');
            // #region agent log
            fetch('http://127.0.0.1:7243/ingest/d3f5dd9c-c95a-47af-bbb0-760cd158a559',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:1164',message:'Cards check',data:{cardsLength:cards.length,cardExists:cards[index]!==undefined},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'D'})}).catch(()=>{});
            // #endregion
            if (!cards[index]) return;
            const statDiv = cards[index].querySelector('.card-stat');
            if (!statDiv) return;
            const originalSmall = statDiv.dataset.originalSmall || statDiv.querySelector('small').innerText;
            if (!statDiv.dataset.originalSmall) statDiv.dataset.originalSmall = originalSmall;

            if (data && data.valid && data.slope > 0) {
                statDiv.innerHTML = `+${data.slope.toFixed(1)} pts <small>${originalSmall}</small>`;
                statDiv.style.color = 'var(--success)';
                // Add interpretation below the stat
                const interpretation = statDiv.parentElement.querySelector('.simple-interpretation') || document.createElement('div');
                interpretation.className = 'simple-interpretation';
                interpretation.style.marginTop = '0.25rem';
                interpretation.textContent = `For every 1 point improvement, ${data.slope.toFixed(1)} points gained.`;
                if (!statDiv.parentElement.querySelector('.simple-interpretation')) {
                    statDiv.parentElement.appendChild(interpretation);
                } else {
                    statDiv.parentElement.querySelector('.simple-interpretation').textContent = interpretation.textContent;
                }
            } else {
                statDiv.innerHTML = `<span style="font-size:1.5rem; color:#ccc;">N/A</span> <small>${originalSmall}</small>`;
                // Remove interpretation if it exists
                const existingInterp = statDiv.parentElement.querySelector('.simple-interpretation');
                if (existingInterp) existingInterp.remove();
            }
        }

        function renderForecastTable(drivers) {
            // #region agent log
            fetch('http://127.0.0.1:7243/ingest/d3f5dd9c-c95a-47af-bbb0-760cd158a559',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:1177',message:'renderForecastTable entry',data:{driversExists:drivers!==null,driversIsArray:Array.isArray(drivers),driversLength:drivers?drivers.length:0},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'C'})}).catch(()=>{});
            // #endregion
            const tbody = document.querySelector('.forecast-table tbody');
            // #region agent log
            fetch('http://127.0.0.1:7243/ingest/d3f5dd9c-c95a-47af-bbb0-760cd158a559',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:1179',message:'Tbody check',data:{tbodyExists:tbody!==null},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'D'})}).catch(()=>{});
            // #endregion
            if (!tbody) return;
            tbody.innerHTML = ''; // Clear existing

            if (!drivers || drivers.length === 0) {
                const tr = document.createElement('tr');
                tr.innerHTML = `<td colspan="3" style="text-align:center; padding: 2rem; color: var(--text-muted);">
                    <em>Predictive modeling data is not available for this dataset version.</em>
                </td>`;
                tbody.appendChild(tr);
                return;
            }

            // Drivers are already ranked by R2 descending
            drivers.forEach(d => {
                const tr = document.createElement('tr');

                // R2 Badge logic
                let strength = "Moderate";
                if (d.r2 > 0.45) strength = "Strong";
                if (d.r2 > 0.55) strength = "Very Strong";
                if (d.r2 < 0.25) strength = "Weak";

                tr.innerHTML = `
                    <td>
                        Increase <span class="strong-text">${d.question_name}</span>
                        <div class="expert-insight">
                            ${d.insight}
                        </div>
                    </td>
                    <td>
                        <span class="impact-arrow">&uarr;</span> Projected <strong>+${d.slope.toFixed(1)} points</strong> in 
                        <span class="strong-text"><span class="tech-tooltip" title="Database ID: ${d.metric_code}">${d.metric_name}</span></span>
                        <div style="font-size:0.75rem; color:#94a3b8; margin-top:0.25rem;">per 1-point increase</div>
                        <div class="simple-interpretation">For every 1 point you improve ${d.question_name.replace(/\[.*?\]\s*/, '')}, ${d.metric_name} improves by ${d.slope.toFixed(1)} points.</div>
                    </td>
                    <td>
                        <span class="badge" style="background:var(--success-bg); color:var(--success); border:none;">
                            R² = ${d.r2.toFixed(2)} (${strength})
                        </span>
                        <div class="simple-interpretation">This explains ${(d.r2 * 100).toFixed(0)}% of ${d.metric_name}. Higher = more reliable.</div>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }

        function renderDeepDiveTable(drivers) {
            // #region agent log
            fetch('http://127.0.0.1:7243/ingest/d3f5dd9c-c95a-47af-bbb0-760cd158a559',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:1222',message:'renderDeepDiveTable entry',data:{driversExists:drivers!==null,driversIsArray:Array.isArray(drivers),driversLength:drivers?drivers.length:0},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'C'})}).catch(()=>{});
            // #endregion
            const tbody = document.querySelector('.analytics-table tbody');
            // #region agent log
            fetch('http://127.0.0.1:7243/ingest/d3f5dd9c-c95a-47af-bbb0-760cd158a559',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({location:'index.html:1224',message:'Analytics tbody check',data:{tbodyExists:tbody!==null},timestamp:Date.now(),sessionId:'debug-session',runId:'run1',hypothesisId:'D'})}).catch(()=>{});
            // #endregion
            if (!tbody) return;
            tbody.innerHTML = '';

            if (!drivers || drivers.length === 0) {
                const tr = document.createElement('tr');
                tr.innerHTML = `<td colspan="4" style="text-align:center; padding: 2rem; color: var(--text-muted);">
                    <em>Detailed correlation data is not available for this dataset version.</em>
                </td>`;
                tbody.appendChild(tr);
                return;
            }

            drivers.forEach(d => {
                const tr = document.createElement('tr');
                const fullText = QUESTION_FULL_TEXT[d.question_code] || `"${d.question_name}..."`;

                tr.innerHTML = `
                    <td>
                        <span class="q-text"><span class="q-code">${d.question_code}</span> ${d.question_name.replace(/\[.*?\]\s*/, '')}</span>
                        <span class="q-full">"${fullText}"</span>
                        <div class="expert-insight">
                             ${d.insight.split("Only users")[0] /* Simple truncation if needed, or just full insight */}
                        </div>
                    </td>
                    <td><span class="tech-tooltip" title="Database ID: ${d.metric_code}">${d.metric_name}</span></td>
                    <td>
                        <span class="stat-value">+${d.slope.toFixed(1)} pts</span>
                        <span class="stat-label">Gain per 1-point increase</span>
                        <div class="simple-interpretation">For every 1 point you improve ${d.question_name.replace(/\[.*?\]\s*/, '')}, ${d.metric_name} improves by ${d.slope.toFixed(1)} points.</div>
                    </td>
                    <td>
                        <span class="r2-badge">R² = ${d.r2.toFixed(2)}</span>
                        <div class="simple-interpretation">This explains ${(d.r2 * 100).toFixed(0)}% of ${d.metric_name}. Higher = more reliable.</div>
                    </td>
                `;
                tbody.appendChild(tr);
            });
        }
    </script>
</body>

</html>